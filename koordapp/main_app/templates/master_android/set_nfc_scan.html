<!DOCTYPE html>
<html lang="de">
{% extends 'base.html' %}
{% load static %}
{% block content %}

<head>
    <link rel="stylesheet" type="text/css" href="{% static 'css/master_android/set_nfc_scan.css' %}"/>
</head>

<body>



    <div class="header_container_back_help">
        <button class="back" onclick="window.location.href = 'http://127.0.0.1:8000/master_tablet/';"> <span class = "arrow"> <i class="arrow_left"></i> </span> <span class="backtext">Zurück</span>  </button>

        <a class="question" href="#popup1">Hilfe</a>

        <div id="popup1" class="popup">
            <div class="popup2">
                <h3>Was muss ich in diesem Anzeigefenster beachten?</h3>

                <div class="content">
                    <p>Hier können Sie den NFC-Chip eines Kinds neu zuweisen. Halten Sie das Armband dafür an den Scanner.
                        Nach erfolreicher Identifizierung des NFC-Chips öffnet sich ein Fenster, in dem Sie die Eigenschaften
                        des NFC-Chip Besitzers einsehen und ändern können. Drücken Sie <strong>"Zurück"</strong> falls Sie zur
                        vorherigen Ansicht zurückkehren möchten.</p>
                </div>

                <a class="close" href="#">&times;</a>

            </div>"
        </div>
    </div>

    <div class ="mid_container">
        <h1 class="default_heading_mid"> Scannen Sie den NFC-Chip den Sie neu setzen möchten. </h1>
        <img src="{% static 'img/placeholder_nfc_scan_transparent.png' %}" alt="NFC-Scan" class="nfc_scan">
        
    </div>
    <form id="form" method="post" action="/your-django-endpoint/">
        {% csrf_token %}
        <input type="hidden" name="tag_id" id="tag_id" value="">
        <!--<input type="submit" value="">-->
    </form>
    <script type="module">
        if ("NDEFReader" in window) {
            document.getElementById('info').value = "Web NFC kann geladen werden";
            const reader = new NDEFReader();
            
            reader.addEventListener("reading", ({ message, serialNumber }) => {
                document.getElementById('tag_id').value = message;
                document.getElementById('form').submit();
                console.log(message.records);
            });
            
            reader.scan();
        } else {
            document.getElementById('info').value = "Web NFC kann nicht geladen werden";
            console.error("Web NFC not supported");
        }
    </script>
</body>
</html>
{% endblock %}